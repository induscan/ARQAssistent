<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validador de Información de Ventas</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(5, end) infinite;
        }
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60% { content: '...'; }
            80%, 100% { content: ''; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function SalesValidator() {
            const [formData, setFormData] = useState({
                clientName: '',
                clientCompany: '',
                clientContact: '',
                productService: '',
                budget: '',
                timeline: '',
                requirements: '',
                competition: '',
                previousInteractions: '',
                decisionMakers: '',
                painPoints: '',
                successCriteria: ''
            });

            const [isLoading, setIsLoading] = useState(false);
            const [result, setResult] = useState(null);
            const [error, setError] = useState('');

            const handleChange = (e) => {
                setFormData({
                    ...formData,
                    [e.target.name]: e.target.value
                });
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');
                setResult(null);

                try {
                    // Construir el prompt para Claude
                    const prompt = `
                    Eres un asistente especializado en ventas que ayuda a evaluar si un vendedor tiene la información mínima necesaria para presentar una propuesta exitosa a un cliente.

                    Por favor, evalúa la siguiente información del vendedor y determina:
                    1. Si tiene información suficiente para proceder con una propuesta
                    2. Qué información crítica le falta
                    3. Recomendaciones específicas para mejorar la propuesta

                    INFORMACIÓN DEL VENDEDOR:
                    
                    Cliente: ${formData.clientName}
                    Empresa del Cliente: ${formData.clientCompany}
                    Información de Contacto: ${formData.clientContact}
                    Producto/Servicio: ${formData.productService}
                    Presupuesto Estimado: ${formData.budget}
                    Timeline/Fecha Límite: ${formData.timeline}
                    Requisitos Específicos: ${formData.requirements}
                    Información de Competencia: ${formData.competition}
                    Interacciones Previas: ${formData.previousInteractions}
                    Tomadores de Decisión: ${formData.decisionMakers}
                    Puntos de Dolor del Cliente: ${formData.painPoints}
                    Criterios de Éxito: ${formData.successCriteria}

                    Responde en formato JSON con la siguiente estructura:
                    {
                        "readyToPropose": boolean,
                        "completenessScore": number (0-100),
                        "missingInformation": [array de strings con información faltante],
                        "recommendations": [array de strings con recomendaciones],
                        "strengths": [array de strings con fortalezas de la información],
                        "summary": "string con resumen ejecutivo"
                    }

                    RESPONDE ÚNICAMENTE CON EL JSON, SIN TEXTO ADICIONAL.
                    `;

                    const response = await fetch('https://api.anthropic.com/v1/messages', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'anthropic-version': '2023-06-01',
                            'x-api-key': process.env.ANTHROPIC_API_KEY || 'tu-api-key-aqui'
                        },
                        body: JSON.stringify({
                            model: 'claude-3-sonnet-20240229',
                            max_tokens: 1000,
                            messages: [
                                { role: 'user', content: prompt }
                            ]
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`Error: ${response.status} - ${response.statusText}`);
                    }

                    const data = await response.json();
                    const claudeResponse = data.content[0].text;
                    
                    // Limpiar la respuesta y parsear JSON
                    const cleanResponse = claudeResponse.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
                    const parsedResult = JSON.parse(cleanResponse);
                    
                    setResult(parsedResult);
                } catch (error) {
                    console.error('Error:', error);
                    setError('Error al procesar la información. Por favor, verifica tu API key y conexión.');
                } finally {
                    setIsLoading(false);
                }
            };

            const resetForm = () => {
                setFormData({
                    clientName: '',
                    clientCompany: '',
                    clientContact: '',
                    productService: '',
                    budget: '',
                    timeline: '',
                    requirements: '',
                    competition: '',
                    previousInteractions: '',
                    decisionMakers: '',
                    painPoints: '',
                    successCriteria: ''
                });
                setResult(null);
                setError('');
            };

            return (
                <div className="min-h-screen gradient-bg">
                    <div className="container mx-auto px-4 py-8">
                        {/* Header */}
                        <div className="text-center mb-8">
                            <h1 className="text-4xl md:text-5xl font-bold text-white mb-4">
                                <i className="fas fa-chart-line mr-3"></i>
                                Validador de Ventas
                            </h1>
                            <p className="text-xl text-blue-100">
                                Valida si tienes la información necesaria para tu propuesta
                            </p>
                        </div>

                        <div className="max-w-4xl mx-auto">
                            <div className="bg-white rounded-2xl card-shadow overflow-hidden">
                                
                                {/* Form Section */}
                                <div className="p-6 md:p-8">
                                    <form onSubmit={handleSubmit} className="space-y-6">
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            {/* Cliente */}
                                            <div>
                                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                    <i className="fas fa-user mr-2 text-blue-500"></i>
                                                    Nombre del Cliente *
                                                </label>
                                                <input
                                                    type="text"
                                                    name="clientName"
                                                    value={formData.clientName}
                                                    onChange={handleChange}
                                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                    placeholder="Ej: Juan Pérez"
                                                    required
                                                />
                                            </div>

                                            {/* Empresa */}
                                            <div>
                                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                    <i className="fas fa-building mr-2 text-blue-500"></i>
                                                    Empresa del Cliente *
                                                </label>
                                                <input
                                                    type="text"
                                                    name="clientCompany"
                                                    value={formData.clientCompany}
                                                    onChange={handleChange}
                                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                    placeholder="Ej: TechCorp SA"
                                                    required
                                                />
                                            </div>

                                            {/* Contacto */}
                                            <div>
                                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                    <i className="fas fa-phone mr-2 text-blue-500"></i>
                                                    Información de Contacto
                                                </label>
                                                <input
                                                    type="text"
                                                    name="clientContact"
                                                    value={formData.clientContact}
                                                    onChange={handleChange}
                                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                    placeholder="Email, teléfono, LinkedIn..."
                                                />
                                            </div>

                                            {/* Producto/Servicio */}
                                            <div>
                                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                    <i className="fas fa-box mr-2 text-blue-500"></i>
                                                    Producto/Servicio *
                                                </label>
                                                <input
                                                    type="text"
                                                    name="productService"
                                                    value={formData.productService}
                                                    onChange={handleChange}
                                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                    placeholder="¿Qué vas a vender?"
                                                    required
                                                />
                                            </div>

                                            {/* Presupuesto */}
                                            <div>
                                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                    <i className="fas fa-dollar-sign mr-2 text-blue-500"></i>
                                                    Presupuesto Estimado
                                                </label>
                                                <input
                                                    type="text"
                                                    name="budget"
                                                    value={formData.budget}
                                                    onChange={handleChange}
                                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                    placeholder="Ej: $50,000 - $100,000"
                                                />
                                            </div>

                                            {/* Timeline */}
                                            <div>
                                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                    <i className="fas fa-calendar mr-2 text-blue-500"></i>
                                                    Timeline/Fecha Límite
                                                </label>
                                                <input
                                                    type="text"
                                                    name="timeline"
                                                    value={formData.timeline}
                                                    onChange={handleChange}
                                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                    placeholder="¿Cuándo necesitan implementar?"
                                                />
                                            </div>
                                        </div>

                                        {/* Campos de texto largo */}
                                        <div className="space-y-6">
                                            <div>
                                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                    <i className="fas fa-list-ul mr-2 text-blue-500"></i>
                                                    Requisitos Específicos
                                                </label>
                                                <textarea
                                                    name="requirements"
                                                    value={formData.requirements}
                                                    onChange={handleChange}
                                                    rows="3"
                                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                    placeholder="Detalles técnicos, funcionalidades requeridas..."
                                                ></textarea>
                                            </div>

                                            <div>
                                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                    <i className="fas fa-users mr-2 text-blue-500"></i>
                                                    Tomadores de Decisión
                                                </label>
                                                <textarea
                                                    name="decisionMakers"
                                                    value={formData.decisionMakers}
                                                    onChange={handleChange}
                                                    rows="2"
                                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                    placeholder="¿Quiénes aprueban la compra? Roles, nombres..."
                                                ></textarea>
                                            </div>

                                            <div>
                                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                    <i className="fas fa-exclamation-triangle mr-2 text-blue-500"></i>
                                                    Puntos de Dolor del Cliente
                                                </label>
                                                <textarea
                                                    name="painPoints"
                                                    value={formData.painPoints}
                                                    onChange={handleChange}
                                                    rows="3"
                                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                    placeholder="¿Qué problemas necesitan resolver?"
                                                ></textarea>
                                            </div>

                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <div>
                                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                        <i className="fas fa-trophy mr-2 text-blue-500"></i>
                                                        Criterios de Éxito
                                                    </label>
                                                    <textarea
                                                        name="successCriteria"
                                                        value={formData.successCriteria}
                                                        onChange={handleChange}
                                                        rows="3"
                                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                        placeholder="¿Cómo medirán el éxito?"
                                                    ></textarea>
                                                </div>

                                                <div>
                                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                        <i className="fas fa-history mr-2 text-blue-500"></i>
                                                        Interacciones Previas
                                                    </label>
                                                    <textarea
                                                        name="previousInteractions"
                                                        value={formData.previousInteractions}
                                                        onChange={handleChange}
                                                        rows="3"
                                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                        placeholder="Reuniones, demos, conversaciones..."
                                                    ></textarea>
                                                </div>
                                            </div>

                                            <div>
                                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                    <i className="fas fa-chess mr-2 text-blue-500"></i>
                                                    Información de Competencia
                                                </label>
                                                <textarea
                                                    name="competition"
                                                    value={formData.competition}
                                                    onChange={handleChange}
                                                    rows="2"
                                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                                    placeholder="¿Están considerando otras opciones?"
                                                ></textarea>
                                            </div>
                                        </div>

                                        {/* Buttons */}
                                        <div className="flex flex-col sm:flex-row gap-4 pt-6">
                                            <button
                                                type="submit"
                                                disabled={isLoading}
                                                className="flex-1 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold py-4 px-8 rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                                            >
                                                {isLoading ? (
                                                    <span>
                                                        <i className="fas fa-spinner fa-spin mr-2"></i>
                                                        Analizando<span className="loading-dots"></span>
                                                    </span>
                                                ) : (
                                                    <span>
                                                        <i className="fas fa-check-circle mr-2"></i>
                                                        Validar Información
                                                    </span>
                                                )}
                                            </button>
                                            
                                            <button
                                                type="button"
                                                onClick={resetForm}
                                                className="flex-1 sm:flex-none bg-gray-500 text-white font-bold py-4 px-8 rounded-lg hover:bg-gray-600 transition-all duration-200"
                                            >
                                                <i className="fas fa-refresh mr-2"></i>
                                                Limpiar
                                            </button>
                                        </div>
                                    </form>
                                </div>

                                {/* Error */}
                                {error && (
                                    <div className="mx-6 mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg">
                                        <i className="fas fa-exclamation-circle mr-2"></i>
                                        {error}
                                    </div>
                                )}

                                {/* Results */}
                                {result && (
                                    <div className="border-t bg-gray-50 p-6 md:p-8">
                                        <h2 className="text-2xl font-bold text-gray-800 mb-6">
                                            <i className="fas fa-chart-pie mr-2 text-blue-500"></i>
                                            Análisis de tu Información
                                        </h2>

                                        {/* Status Card */}
                                        <div className={`p-6 rounded-xl mb-6 ${result.readyToPropose 
                                            ? 'bg-green-100 border border-green-300' 
                                            : 'bg-yellow-100 border border-yellow-300'}`}>
                                            <div className="flex items-center justify-between flex-wrap gap-4">
                                                <div>
                                                    <h3 className={`text-xl font-bold ${result.readyToPropose ? 'text-green-800' : 'text-yellow-800'}`}>
                                                        {result.readyToPropose ? (
                                                            <><i className="fas fa-thumbs-up mr-2"></i>¡Listo para proponer!</>
                                                        ) : (
                                                            <><i className="fas fa-exclamation-triangle mr-2"></i>Necesitas más información</>
                                                        )}
                                                    </h3>
                                                    <p className={`${result.readyToPropose ? 'text-green-700' : 'text-yellow-700'}`}>
                                                        {result.summary}
                                                    </p>
                                                </div>
                                                <div className="text-center">
                                                    <div className={`text-3xl font-bold ${result.readyToPropose ? 'text-green-600' : 'text-yellow-600'}`}>
                                                        {result.completenessScore}%
                                                    </div>
                                                    <div className="text-sm text-gray-600">Completitud</div>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                            {/* Missing Information */}
                                            {result.missingInformation.length > 0 && (
                                                <div className="bg-white p-6 rounded-xl border border-red-200">
                                                    <h4 className="text-lg font-bold text-red-800 mb-4">
                                                        <i className="fas fa-times-circle mr-2"></i>
                                                        Información Faltante
                                                    </h4>
                                                    <ul className="space-y-2">
                                                        {result.missingInformation.map((item, index) => (
                                                            <li key={index} className="flex items-start text-red-700">
                                                                <i className="fas fa-minus-circle mr-2 mt-1 text-red-500"></i>
                                                                {item}
                                                            </li>
                                                        ))}
                                                    </ul>
                                                </div>
                                            )}

                                            {/* Strengths */}
                                            {result.strengths.length > 0 && (
                                                <div className="bg-white p-6 rounded-xl border border-green-200">
                                                    <h4 className="text-lg font-bold text-green-800 mb-4">
                                                        <i className="fas fa-check-circle mr-2"></i>
                                                        Fortalezas
                                                    </h4>
                                                    <ul className="space-y-2">
                                                        {result.strengths.map((item, index) => (
                                                            <li key={index} className="flex items-start text-green-700">
                                                                <i className="fas fa-plus-circle mr-2 mt-1 text-green-500"></i>
                                                                {item}
                                                            </li>
                                                        ))}
                                                    </ul>
                                                </div>
                                            )}

                                            {/* Recommendations */}
                                            {result.recommendations.length > 0 && (
                                                <div className="lg:col-span-2 bg-white p-6 rounded-xl border border-blue-200">
                                                    <h4 className="text-lg font-bold text-blue-800 mb-4">
                                                        <i className="fas fa-lightbulb mr-2"></i>
                                                        Recomendaciones
                                                    </h4>
                                                    <ul className="space-y-3">
                                                        {result.recommendations.map((item, index) => (
                                                            <li key={index} className="flex items-start text-blue-700">
                                                                <i className="fas fa-arrow-right mr-2 mt-1 text-blue-500"></i>
                                                                {item}
                                                            </li>
                                                        ))}
                                                    </ul>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>

                    {/* Footer */}
                    <div className="text-center text-white py-8">
                        <p className="text-blue-100">
                            <i className="fas fa-robot mr-2"></i>
                            Powered by Claude AI • Optimiza tus propuestas de venta
                        </p>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<SalesValidator />, document.getElementById('root'));
    </script>
</body>
</html>
